CREATE TABLE Usuario (
    id_usuario NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(50) NOT NULL,
    apellido VARCHAR2(50) NOT NULL,
    email VARCHAR2(100) UNIQUE NOT NULL,
    telefono VARCHAR2(20),
    fecha_nacimiento DATE,
    genero CHAR(1),
    salario NUMBER(10,2),
    fecha_registro TIMESTAMP DEFAULT SYSTIMESTAMP
);





CREATE TABLE pais (
    id_pais NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(100)
);

CREATE TABLE estado (
    id_estado NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(100),
    id_pais NUMBER,
    CONSTRAINT fk_estado_pais
        FOREIGN KEY (id_pais)
        REFERENCES pais(id_pais)
        ON DELETE SET NULL
);

CREATE TABLE municipio(
    id_municipio NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre VARCHAR2(150),
    id_estado NUMBER,
    CONSTRAINT fk_muncipio_estado
        FOREIGN KEY (id_estado)
        REFERENCES estado(id_estado)
        ON DELETE SET NULL
);

CREATE TABLE colonia(
    id_colonia NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    nombre varchar2(150),
    id_municipio NUMBER,
    CONSTRAINT fk_colonia_municipio
        FOREIGN KEY (id_municipio)
        REFERENCES municipio(id_municipio)
        ON DELETE SET NULL
);

CREATE TABLE codigo_postal(
    id_cp NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    cp NUMBER(5),
    id_colonia NUMBER,
    CONSTRAINT fk_codigo_postal_colonia
        FOREIGN KEY (id_colonia)
        REFERENCES colonia(id_colonia)
        ON DELETE SET NULL
);


ALTER TABLE Usuario
ADD id_colonia NUMBER;

ALTER TABLE Usuario
ADD CONSTRAINT fk_usuario_colonia
    FOREIGN KEY (id_colonia)
    REFERENCES colonia(id_colonia)
    ON DELETE SET NULL;






-- 1️⃣ Agregar columnas permitiendo NULL
ALTER TABLE usuario ADD estado_id NUMBER(19,0);
ALTER TABLE usuario ADD municipio_id NUMBER(19,0);
ALTER TABLE usuario ADD pais_id NUMBER(19,0);

-- 2️⃣ Rellenar valores para filas existentes
-- Ajusta los valores por defecto según lo que necesites
UPDATE usuario SET estado_id = 1 WHERE estado_id IS NULL;
UPDATE usuario SET municipio_id = 1 WHERE municipio_id IS NULL;
UPDATE usuario SET pais_id = 1 WHERE pais_id IS NULL;

-- 3️⃣ Hacer las columnas NOT NULL
ALTER TABLE usuario MODIFY estado_id NUMBER(19,0) NOT NULL;
ALTER TABLE usuario MODIFY municipio_id NUMBER(19,0) NOT NULL;
ALTER TABLE usuario MODIFY pais_id NUMBER(19,0) NOT NULL;



*** CREACION DE SECUENCIA, BORRADO Y MODIFICACION (SEQUENCE)

SELECT SEQ_MUNICIPIO.CURRVAL FROM DUAL;

SELECT MAX(ID_MUNICIPIO) FROM MUNICIPIO;

DROP SEQUENCE SEQ_MUNICIPIO;

CREATE SEQUENCE SEQ_MUNICIPIO
START WITH 18
INCREMENT BY 1
NOCACHE
NOCYCLE;

SELECT SEQ_MUNICIPIO.NEXTVAL FROM DUAL;





Subquerys
-- Aguascalientes
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Aguascalientes', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Aguascalientes';

-- Baja California
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Tijuana', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Baja California';

-- Jalisco
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Guadalajara', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Jalisco';

-- Nuevo León
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Monterrey', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Nuevo León';

-- Puebla
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Puebla', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Puebla';

-- Baja California Sur
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'La Paz', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Baja California Sur';

-- Campeche
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Campeche', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Campeche';

-- Coahuila
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Saltillo', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Coahuila';

-- Colima
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Colima', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Colima';

-- Chiapas
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Tuxtla Gutiérrez', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Chiapas';

-- Chihuahua
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Chihuahua', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Chihuahua';

-- Durango
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Durango', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Durango';

-- Guanajuato
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'León', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Guanajuato';

-- Guerrero
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Acapulco', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Guerrero';

-- Hidalgo
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Pachuca', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Hidalgo';

-- Estado de México
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Toluca', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Estado de Mexico';


-- Michoacán
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Morelia', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Michoacán';

-- Morelos
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Cuernavaca', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Morelos';

-- Nayarit
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Tepic', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Nayarit';





-- Oaxaca
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Oaxaca de Juárez', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Oaxaca';

-- Querétaro
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Querétaro', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Querétaro';

-- Quintana Roo
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Benito Juárez', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Quintana Roo';

-- San Luis Potosí
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'San Luis Potosí', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'San Luis Potosí';

-- Sinaloa
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Culiacán', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Sinaloa';

-- Sonora
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Hermosillo', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Sonora';

-- Tabasco
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Villahermosa', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Tabasco';

-- Tamaulipas
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Ciudad Victoria', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Tamaulipas';

-- Tlaxcala
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Tlaxcala', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Tlaxcala';

-- Veracruz
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Xalapa', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Veracruz';

-- Yucatán
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Mérida', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Yucatán';

-- Zacatecas
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO)
SELECT SEQ_MUNICIPIO.NEXTVAL, 'Zacatecas', ID_ESTADO
FROM ESTADO WHERE NOMBRE = 'Zacatecas';

-- EdoMex
INSERT INTO municipio (id_municipio, nombre, id_estado)
VALUES (SEQ_MUNICIPIO.NEXTVAL, 'Ecatepec', 15);
INSERT INTO municipio (id_municipio, nombre, id_estado)
VALUES (SEQ_MUNICIPIO.NEXTVAL, 'Naucalpan', 15);



INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (2,  'Álvaro Obregón', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (3,  'Azcapotzalco', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (4,  'Benito Juárez', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (5,  'Coyoacán', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (6,  'Cuajimalpa de Morelos', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (7,  'Cuauhtémoc', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (8,  'Gustavo A. Madero', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (9,  'Iztacalco', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (10, 'Iztapalapa', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (11, 'La Magdalena Contreras', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (12, 'Miguel Hidalgo', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (13, 'Milpa Alta', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (14, 'Tláhuac', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (15, 'Tlalpan', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (16, 'Venustiano Carranza', 8);
INSERT INTO MUNICIPIO (ID_MUNICIPIO, NOMBRE, ID_ESTADO) VALUES (17, 'Xochimilco', 8);

COMMIT;







